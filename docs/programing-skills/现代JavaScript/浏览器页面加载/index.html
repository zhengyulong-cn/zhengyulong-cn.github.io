<!doctype html>
<html lang="zh-CN" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-programing-skills/现代JavaScript/浏览器页面加载/index">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">页面生命周期 | 筝语的博客</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://zhengyulong-cn.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://zhengyulong-cn.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://zhengyulong-cn.github.io/docs/programing-skills/现代JavaScript/浏览器页面加载/"><meta data-rh="true" name="docusaurus_locale" content="zh-CN"><meta data-rh="true" name="docsearch:language" content="zh-CN"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="页面生命周期 | 筝语的博客"><meta data-rh="true" name="description" content="主要包含以下事件："><meta data-rh="true" property="og:description" content="主要包含以下事件："><link data-rh="true" rel="icon" href="/img/logo.svg"><link data-rh="true" rel="canonical" href="https://zhengyulong-cn.github.io/docs/programing-skills/现代JavaScript/浏览器页面加载/"><link data-rh="true" rel="alternate" href="https://zhengyulong-cn.github.io/docs/programing-skills/现代JavaScript/浏览器页面加载/" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://zhengyulong-cn.github.io/docs/programing-skills/现代JavaScript/浏览器页面加载/" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.7dc8b376.css">
<link rel="preload" href="/assets/js/runtime~main.9743336f.js" as="script">
<link rel="preload" href="/assets/js/main.77104bc7.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="我的网站Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="我的网站Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">筝语的博客</b></a><a class="navbar__item navbar__link" href="/docs/programing-skills/">专业技术</a><a class="navbar__item navbar__link" href="/docs/interview/你问我答八股文/">面试</a><a class="navbar__item navbar__link" href="/docs/quick-links/">快捷链接</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><main class="docMainContainer_gTbr docMainContainerEnhanced_Uz_u"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>页面生命周期</h1><p>主要包含以下事件：</p><ul><li><code>DOMContentLoaded</code>：DOM 已经就绪，JS可以访问 DOM 节点，初始化页面</li><li><code>load</code>：外部资源已加载完成，样式已被应用，图片大小也已知了</li><li><code>beforeunload</code>：用户正在离开，我们可以检查用户是否保存了更改，并询问他是否真的要离开</li><li><code>unload</code>：用户几乎已经离开了，但是我们仍然可以启动一些操作，例如发送统计数据</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="domcontentloaded">DOMContentLoaded<a href="#domcontentloaded" class="hash-link" aria-label="DOMContentLoaded的直接链接" title="DOMContentLoaded的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="基本使用">基本使用<a href="#基本使用" class="hash-link" aria-label="基本使用的直接链接" title="基本使用的直接链接">​</a></h3><blockquote><p>必须使用 addEventListener 来捕获它</p></blockquote><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">addEventListener</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;DOMContentLoaded&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ready</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>例子：</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">  </span><span class="token script language-javascript keyword" style="color:#00009f">function</span><span class="token script language-javascript"> </span><span class="token script language-javascript function" style="color:#d73a49">ready</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:#393A34">{</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    </span><span class="token script language-javascript function" style="color:#d73a49">alert</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript string" style="color:#e3116c">&#x27;DOM is ready&#x27;</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    </span><span class="token script language-javascript comment" style="color:#999988;font-style:italic">// 图片目前尚未加载完成（除非已经被缓存），所以图片的大小为 0x0</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    </span><span class="token script language-javascript function" style="color:#d73a49">alert</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript template-string template-punctuation string" style="color:#e3116c">`</span><span class="token script language-javascript template-string string" style="color:#e3116c">Image size: </span><span class="token script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token script language-javascript template-string interpolation">img</span><span class="token script language-javascript template-string interpolation punctuation" style="color:#393A34">.</span><span class="token script language-javascript template-string interpolation property-access">offsetWidth</span><span class="token script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token script language-javascript template-string string" style="color:#e3116c">x</span><span class="token script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token script language-javascript template-string interpolation">img</span><span class="token script language-javascript template-string interpolation punctuation" style="color:#393A34">.</span><span class="token script language-javascript template-string interpolation property-access">offsetHeight</span><span class="token script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token script language-javascript template-string template-punctuation string" style="color:#e3116c">`</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">  </span><span class="token script language-javascript punctuation" style="color:#393A34">}</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">  </span><span class="token script language-javascript dom variable" style="color:#36acaa">document</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">addEventListener</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript string" style="color:#e3116c">&quot;DOMContentLoaded&quot;</span><span class="token script language-javascript punctuation" style="color:#393A34">,</span><span class="token script language-javascript"> ready</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">img</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">img</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">src</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">https://en.js.cx/clipart/train.gif?speed=1&amp;cache=0</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="domcontentloaded-和脚本">DOMContentLoaded 和脚本<a href="#domcontentloaded-和脚本" class="hash-link" aria-label="DOMContentLoaded 和脚本的直接链接" title="DOMContentLoaded 和脚本的直接链接">​</a></h3><p>当浏览器在解析HTML页面时遇到了<code>&lt;script&gt;...&lt;/script&gt;</code>标签，将无法继续构建DOM树（译注：UI渲染线程与JS引擎是互斥的，当JS引擎执行时UI线程会被挂起），必须立即执行脚本。所以<code>DOMContentLoaded</code>必须等待脚本执行结束。</p><blockquote><p>不会阻塞<code>DOMContentLoaded</code>的脚本：
1.带async和defer的外部脚本
2.使用<code>document.createElement(&#x27;script&#x27;)</code>动态生成并添加到网页的脚本也不会阻塞<code>DOMContentLoaded</code></p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="domcontentloaded-与样式表">DOMContentLoaded 与样式表<a href="#domcontentloaded-与样式表" class="hash-link" aria-label="DOMContentLoaded 与样式表的直接链接" title="DOMContentLoaded 与样式表的直接链接">​</a></h3><p><code>DOMContentLoaded</code>需要等待脚本的执行，脚本又需要等待样式的加载</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">link</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">text/css</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">rel</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">stylesheet</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">href</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">style.css</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">  </span><span class="token script language-javascript comment" style="color:#999988;font-style:italic">// 脚本直到样式表加载完毕后才会执行。</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">  </span><span class="token script language-javascript function" style="color:#d73a49">alert</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript function" style="color:#d73a49">getComputedStyle</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript dom variable" style="color:#36acaa">document</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">body</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">marginTop</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="windowonload">window.onload<a href="#windowonload" class="hash-link" aria-label="window.onload的直接链接" title="window.onload的直接链接">​</a></h2><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">  </span><span class="token script language-javascript dom variable" style="color:#36acaa">window</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method-variable function-variable method function property-access" style="color:#d73a49">onload</span><span class="token script language-javascript"> </span><span class="token script language-javascript operator" style="color:#393A34">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript keyword" style="color:#00009f">function</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:#393A34">{</span><span class="token script language-javascript"> </span><span class="token script language-javascript comment" style="color:#999988;font-style:italic">// 与此相同 window.addEventListener(&#x27;load&#x27;, (event) =&gt; {</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    </span><span class="token script language-javascript function" style="color:#d73a49">alert</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript string" style="color:#e3116c">&#x27;Page loaded&#x27;</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    </span><span class="token script language-javascript comment" style="color:#999988;font-style:italic">// 此时图片已经加载完成</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    </span><span class="token script language-javascript function" style="color:#d73a49">alert</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript template-string template-punctuation string" style="color:#e3116c">`</span><span class="token script language-javascript template-string string" style="color:#e3116c">Image size: </span><span class="token script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token script language-javascript template-string interpolation">img</span><span class="token script language-javascript template-string interpolation punctuation" style="color:#393A34">.</span><span class="token script language-javascript template-string interpolation property-access">offsetWidth</span><span class="token script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token script language-javascript template-string string" style="color:#e3116c">x</span><span class="token script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token script language-javascript template-string interpolation">img</span><span class="token script language-javascript template-string interpolation punctuation" style="color:#393A34">.</span><span class="token script language-javascript template-string interpolation property-access">offsetHeight</span><span class="token script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token script language-javascript template-string template-punctuation string" style="color:#e3116c">`</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">  </span><span class="token script language-javascript punctuation" style="color:#393A34">}</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">img</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">img</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">src</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">https://en.js.cx/clipart/train.gif?speed=1&amp;cache=0</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>window.onload</code>会等待所有图片加载完毕后才执行，最终结果如下：</p><p><img loading="lazy" src="data:image/png;base64,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" width="547" height="145" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="windowonunload">window.onunload<a href="#windowonunload" class="hash-link" aria-label="window.onunload的直接链接" title="window.onunload的直接链接">​</a></h2><p>当访问者离开页面时，window 对象上的 unload 事件就会被触发</p><blockquote><p>但根据官方文档，不建议使用该事件</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="windowonbeforeunload">window.onbeforeunload<a href="#windowonbeforeunload" class="hash-link" aria-label="window.onbeforeunload的直接链接" title="window.onbeforeunload的直接链接">​</a></h2><p>如果用户即将离开页面或者关闭窗口时，beforeunload事件将会被触发以进行额外的确认</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token dom variable" style="color:#36acaa">window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">addEventListener</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;beforeunload&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Cancel the event</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    e</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">preventDefault</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Chrome requires returnValue to be set</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    e</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">returnValue</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;自定义文本&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token dom variable" style="color:#36acaa">window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">onbeforeunload</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">event</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token spread operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol><li>HTML规范建议作者使用 Event.preventDefault() 而非 Event.returnValue 的方式来提示用户。但是，该种方法还没有得到全部浏览器的支持，所以需要配合使用。</li><li>如果不需要展示弹窗，不使用 <code>Event.preventDefault()</code>，<code>Event.returnValue</code>即可。</li><li>returnValue自定义文本无效：从Firefox 44，Chrome 51，Opera 38，和Safari 9.1以后，返回文本将不会被展示，换言之，无法自定义弹窗提示文本。</li><li>alert，confirm，prompt不执行：在一些浏览器中，在onbeforeunload中调用alert，confirm，prompt等方法会被忽略。</li><li>onbeforeunload无效：在Chrome和Firefox中，页面加载完成后，如果用户未对页面进行操作，比如“点击”、“输入”等等，onbeforeunload将不会被执行。而在Safari中onbeforeunload总是会被执行。</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="readystate">readyState<a href="#readystate" class="hash-link" aria-label="readyState的直接链接" title="readyState的直接链接">​</a></h2><p>它有 3 个可能值：</p><ul><li>loading —— 文档正在被加载。</li><li>interactive —— 文档被全部读取。</li><li>complete —— 文档被全部读取，并且所有资源（例如图片等）都已加载完成。</li></ul><p>所以，我们可以检查 <code>document.readyState</code> 并设置一个处理程序，或在代码准备就绪时立即执行它。</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">work</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/*...*/</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">readyState</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;loading&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 仍在加载，等待事件</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">addEventListener</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;DOMContentLoaded&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> work</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// DOM 已就绪！</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">work</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>async和defer</h1><p>现代网站中在执行<code>&lt;script&gt;...&lt;/script&gt;</code>或外部脚本<code>&lt;script src=&quot;...&quot;&gt;&lt;/script&gt;</code>时候必须停止构建DOM，立刻执行此脚本，执行结束后才能继续处理剩余的页面。
造成的问题：
1.脚本不能访问到位于它们下面的DOM元素
2.笨重的脚本可能阻塞页面
可以将脚本放在页面底部，此时就能解决上述问题，但这种方式不是完美的，对于长的HTML文档来说，如果网速较慢，可能会造成明显的延迟。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="defer">defer<a href="#defer" class="hash-link" aria-label="defer的直接链接" title="defer的直接链接">​</a></h2><p>defer特性：</p><ul><li>不会阻塞页面</li><li>总是要等到 DOM 解析完毕，但在 DOMContentLoaded 事件之前执行</li></ul><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">...content before scripts...</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">  </span><span class="token script language-javascript dom variable" style="color:#36acaa">document</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">addEventListener</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript string" style="color:#e3116c">&#x27;DOMContentLoaded&#x27;</span><span class="token script language-javascript punctuation" style="color:#393A34">,</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript"> </span><span class="token script language-javascript arrow operator" style="color:#393A34">=&gt;</span><span class="token script language-javascript"> </span><span class="token script language-javascript function" style="color:#d73a49">alert</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript string" style="color:#e3116c">&quot;DOM ready after defer!&quot;</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">defer</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">src</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">https://javascript.info/article/script-async-defer/long.js?speed=1</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">...content after scripts...</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol><li>页面内容立即显示。</li><li>DOMContentLoaded 事件处理程序等待具有 defer 特性的脚本执行完成。它仅在脚本下载且执行结束后才会被触发。<h2 class="anchor anchorWithStickyNavbar_LWe7" id="async">async<a href="#async" class="hash-link" aria-label="async的直接链接" title="async的直接链接">​</a></h2></li></ol><p>async特性：</p><ul><li>不会阻塞页面</li><li>async脚本是<strong>独立的</strong>，其他脚本不会等待 async 脚本加载完成，同样，async 脚本也不会等待其他脚本</li><li>DOMContentLoaded 和异步脚本不会彼此等待</li></ul><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">...content before scripts...</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">  </span><span class="token script language-javascript dom variable" style="color:#36acaa">document</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">addEventListener</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript string" style="color:#e3116c">&#x27;DOMContentLoaded&#x27;</span><span class="token script language-javascript punctuation" style="color:#393A34">,</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript"> </span><span class="token script language-javascript arrow operator" style="color:#393A34">=&gt;</span><span class="token script language-javascript"> </span><span class="token script language-javascript function" style="color:#d73a49">alert</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript string" style="color:#e3116c">&quot;DOM ready!&quot;</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">async</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">src</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">https://javascript.info/article/script-async-defer/long.js</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">async</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">src</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">https://javascript.info/article/script-async-defer/small.js</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">...content after scripts...</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol><li>页面内容立刻显示出来：加载写有 async 的脚本不会阻塞页面渲染。</li><li>DOMContentLoaded 可能在 async 之前或之后触发，不能保证谁先谁后。</li><li>较小的脚本 small.js 排在第二位，但可能会比 long.js 这个长脚本先加载完成，所以 small.js 会先执行。虽然，可能是 long.js 先加载完成，如果它被缓存了的话，那么它就会先执行。换句话说，异步脚本以“加载优先”的顺序执行。</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="对比">对比<a href="#对比" class="hash-link" aria-label="对比的直接链接" title="对比的直接链接">​</a></h2><p><img loading="lazy" alt="image.png" src="/assets/images/defer和async-cbd31bbbed4aa4dc31a35a87f9b331b4.png" width="787" height="800" class="img_ev3q"></p><blockquote><p>defer和async特性仅适用于外部脚本，如果<code>&lt;script&gt;</code>脚本没有 src，则会忽略 defer 特性。</p></blockquote><table><thead><tr><th></th><th>顺序</th><th>DOMContentLoaded</th></tr></thead><tbody><tr><td>async</td><td>加载优先顺序。脚本在文档中的顺序不重要 —— 先加载完成的先执行</td><td>不相关。可能在文档加载完成前加载并执行完毕。如果脚本很小或者来自于缓存，同时文档足够长，就会发生这种情况。</td></tr><tr><td>defer</td><td>文档顺序（它们在文档中的顺序）</td><td>在文档加载和解析完成之后（如果需要，则会等待），即在 DOMContentLoaded 之前执行。</td></tr></tbody></table><p>所以async用在那些完全不依赖其他脚本的脚本上</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="动态脚本">动态脚本<a href="#动态脚本" class="hash-link" aria-label="动态脚本的直接链接" title="动态脚本的直接链接">​</a></h2><p>我们可以使用 JavaScript 动态地创建一个脚本，并将其附加（append）到文档（document）中</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">loadScript</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">src</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> script </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">createElement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;script&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  script</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">src</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> src</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  script</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">async</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">body</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">script</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// long.js 先执行，因为代码中设置了 async=false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">loadScript</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;/article/script-async-defer/long.js&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">loadScript</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;/article/script-async-defer/small.js&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>资源加载</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="事件">事件<a href="#事件" class="hash-link" aria-label="事件的直接链接" title="事件的直接链接">​</a></h2><p>主要有两个事件：</p><ul><li>onload —— 成功加载</li><li>onerror —— 出现 error</li></ul><p>加载脚本：</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> script </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">createElement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;script&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 可以从任意域（domain），加载任意脚本</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">script</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">src</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.3.0/lodash.js&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">head</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">script</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">script</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">onload</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 该脚本创建了一个变量 &quot;_&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">alert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> _</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">VERSION</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 显示库的版本</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">script</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">onerror</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">alert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Error loading &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">src</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Error loading https://example.com/404.js</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>加载图片：</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> img </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">createElement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;img&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">img</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">src</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;https://js.cx/clipart/train.gif&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// (*)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">img</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">onload</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">alert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">`</span><span class="token maybe-class-name">Image</span><span class="token plain"> loaded</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> size $</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">img</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">width</span><span class="token punctuation" style="color:#393A34">}</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">$</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">img</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">height</span><span class="token plain">`</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">img</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">onerror</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">alert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Error occurred while loading image&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="跨源策略">跨源策略<a href="#跨源策略" class="hash-link" aria-label="跨源策略的直接链接" title="跨源策略的直接链接">​</a></h2><p>这里有一条规则：来自一个网站的脚本无法访问其他网站的内容。例如，位于 <code>https://facebook.com</code> 的脚本无法读取位于 <code>https://gmail.com</code> 的用户邮箱。或者，更确切地说，一个源（域/端口/协议三者）无法获取另一个源（origin）的内容。因此，即使我们有一个子域，或者仅仅是另一个端口，这都是不同的源，彼此无法相互访问。</p><p>这里有三个级别的跨源访问：</p><ol><li>无 <code>crossorigin</code> 特性 —— 禁止访问</li><li><code>crossorigin=&quot;anonymous&quot;</code> —— 如果服务器的响应带有包含 <code>*</code> 或我们的源（origin）的 <code>header Access-Control-Allow-Origin</code>，则允许访问。浏览器不会将授权信息和 cookie 发送到远程服务器</li><li><code>crossorigin=&quot;use-credentials&quot;</code> —— 如果服务器发送回带有我们的源的 header <code>Access-Control-Allow-Origin</code> 和 <code>Access-Control-Allow-Credentials: true</code>，则允许访问。浏览器会将授权信息和 cookie 发送到远程服务器</li></ol><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">script</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token dom variable" style="color:#36acaa">window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">onerror</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">message</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> url</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> line</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> col</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> errorObj</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">alert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">message</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string string" style="color:#e3116c">\n</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">url</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string string" style="color:#e3116c">, </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">line</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string string" style="color:#e3116c">:</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">col</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">script</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">script crossorigin</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;anonymous&quot;</span><span class="token plain"> src</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;https://cors.javascript.info/article/onload-onerror/crossorigin/error.js&quot;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">script</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#domcontentloaded" class="table-of-contents__link toc-highlight">DOMContentLoaded</a><ul><li><a href="#基本使用" class="table-of-contents__link toc-highlight">基本使用</a></li><li><a href="#domcontentloaded-和脚本" class="table-of-contents__link toc-highlight">DOMContentLoaded 和脚本</a></li><li><a href="#domcontentloaded-与样式表" class="table-of-contents__link toc-highlight">DOMContentLoaded 与样式表</a></li></ul></li><li><a href="#windowonload" class="table-of-contents__link toc-highlight">window.onload</a></li><li><a href="#windowonunload" class="table-of-contents__link toc-highlight">window.onunload</a></li><li><a href="#windowonbeforeunload" class="table-of-contents__link toc-highlight">window.onbeforeunload</a></li><li><a href="#readystate" class="table-of-contents__link toc-highlight">readyState</a></li><li><a href="#defer" class="table-of-contents__link toc-highlight">defer</a></li><li><a href="#对比" class="table-of-contents__link toc-highlight">对比</a></li><li><a href="#动态脚本" class="table-of-contents__link toc-highlight">动态脚本</a></li><li><a href="#事件" class="table-of-contents__link toc-highlight">事件</a></li><li><a href="#跨源策略" class="table-of-contents__link toc-highlight">跨源策略</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023-present zhengyu. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.9743336f.js"></script>
<script src="/assets/js/main.77104bc7.js"></script>
</body>
</html>