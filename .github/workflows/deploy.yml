name: Github Page

on:
  push:
    branches:
      - master
  workflow_dispatch:

jobs:
  # algolia:
  #   runs-on: ubuntu-latest
  #   steps:
  #     - uses: actions/checkout@v3
  #     - name: Get the content of algolia.json as config
  #       id: algolia_config
  #       run: echo "config=$(cat crawlerConfig.json | jq -r tostring)" >> $GITHUB_OUTPUT
  #     - name: Push indices to Algolia
  #       uses: signcl/docsearch-scraper-action@master
  #       env:
  #         APPLICATION_ID: ${{ secrets.APPLICATION_ID }}
  #         API_KEY: ${{ secrets.API_KEY }}
  #         CONFIG: ${{ steps.algolia_config.outputs.config }}

  deploy:
    permissions:
      contents: write
    runs-on: ubuntu-latest

    env:
      NODE_VERSION: "16"

    steps:
      - name: æ£€å‡ºä»“åº“ ğŸš€
        uses: actions/checkout@v3
        with:
          fetch-depth: 0

      - name: è®¾ç½®Node.jsç‰ˆæœ¬ ğŸš€
        uses: actions/setup-node@v3
        with:
          node-version: ${{ env.NODE_VERSION }}

      - name: å®‰è£…ä¾èµ– ğŸš€
        run: npm install --frozen-lockfile

      - name: æ„å»ºDocusaurusé¡¹ç›® ğŸš€
        run: npm run build
      
      # - name: è·¨ä»“åº“éƒ¨ç½²ä»£ç  ğŸš€
      #   uses: crazy-max/ghaction-github-pages@v3
      #   with: 
      #     # repo: JonnyLong-cn/long-essays
      #     repo: zhengyulong-cn/zhengyulong-cn.github.io
      #     target_branch: master
      #     # éƒ¨ç½²ç›®å½•
      #     build_dir: build
      #     commit_message: è‡ªåŠ¨åŒ–éƒ¨ç½²æ„å»ºçš„Docusaurusé¡µé¢ ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€
      #   env:
      #     GH_PAT: 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
      - name: ä»£ç éƒ¨ç½² ğŸš€
        uses: peaceiris/actions-gh-pages@v3
        with:
          publish_dir: ./build
          commit_message: è‡ªåŠ¨åŒ–éƒ¨ç½²æ„å»ºçš„Docusaurusé¡µé¢ ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€
          github_token: ${{ secrets.GITHUB_TOKEN }}